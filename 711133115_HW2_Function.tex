\input{711133115_preamble_CJK}   % 使用自己維護的定義檔
%變更章節數字為中文數字
\geometry{a4paper,left=2.5cm,right=2.5cm,top=2cm,bottom=2cm}
\usepackage{fancyhdr}
\pagestyle{fancy}
%\fancyhf{}
%\fancyhead[LE,RO]{overleaf}
%\fancyhead[RE,LO]{guides}
%\fancyhead[CE,CO]{\leftmark}
%\fancyhead[LE,RO]{\thepage}


\title{{\MB Python 基本機率函數繪圖}}	% 使用設定的字型
\author{{\BB 郭翊萱 711133115}}				% 使用設定的小字體
\date{{\ST 2022.10. }} 			
 
\begin{document}
\maketitle
\fontsize{12}{22pt}\selectfont 
%\chapter{ {\MB Python 基本機率函數繪圖}}

Python 跟 R 是很常拿來作統計分析的程式語言，在 R 中常常使用 ggplot2 與 shiny 來繪製統計相關圖形，而在 Python 中則廣為使用 Matplotlib、Plotly 與 seaborn 來進行繪圖。在此文中，使用 Matplotlib 來進行一些基本機率函數圖形繪製，以幫助熟練使用套件 Matplotlib。另外，本文亦將在最後進行一個小專題練習。

\section{基本機率函數繪圖}
首先，本文在此介紹幾個基本機率函數圖形的繪製，以供之後利用套件 Matplotlib 進行繪圖之用。

\begin{itemize}
\item[$\bullet$] $f(x)=sin(x)+cos(x)$
\bigskip
	\begin{lstlisting}
import numpy as np
import matplotlib.pyplot as plt

x = np.linspace(-3*np.pi, 3*np.pi, 300)
y = np.sin(x) + np.cos(x)

fig, ax = plt.subplots(1)#畫布上一個圖形
ax.plot(x, y, color='skyblue')
ax.set_xticks(np.array([-3, -2, -1, 0, 1, 2, 3])*np.pi)
ax.set_xticklabels(['-3$\pi$', '-2$\pi$', '$\pi$', '0', '$\pi$','2$\pi$','3$\pi$'], \
        fontsize=10, color = 'b')
ax.set_ylim([-2, 2])
ax.grid(True)
plt.title("f(x)=sin(x)+cos(x)")
plt.show()
	\end{lstlisting}
\bigskip

\begin{figure}[H]
    \centering
        \includegraphics[scale=0.6]{/Users/guoyixuan/Documents/vscodepython/Statistical Calculation/Homework2_Function/image_hw2/1.png}
    \caption{f(x)=sin(x)+cos(x)}
    \label{fig:sincos}
\end{figure}


\item[$\bullet$] $f(x)=(1-exp(-2x))/(1+exp(-2x))$

\bigskip
\begin{lstlisting}
import matplotlib.pyplot as plt
import numpy as np
 
x = np.arange(-10,11,1)#type(x):array
# formulate a function f
f = lambda x : (1 - np.exp(-2*x)) / (1 + np.exp(-2*x))
 
fig = plt.figure(figsize=[6, 4])
plt.plot(x, f(x),  color = 'r')
plt.grid(visible = True, color='g',  linewidth=0.5)
plt.xlabel('X'), plt.ylabel('Y')
plt.ylim(-1.5,1.5)
plt.xlim(-10,10)
plt.axhline(1.01,color="b",linestyle="--")
plt.axhline(-1.01,color="b",linestyle="--")
plt.title('$f(x)=(1-exp(-2x))/(1+exp(-2x))$')
plt.show()
\end{lstlisting}

\begin{figure}[H]
    \centering
        \includegraphics[scale=0.6]{/Users/guoyixuan/Documents/vscodepython/Statistical Calculation/Homework2_Function/image_hw2/2.png}
    \caption{f(x)=(1-exp(-2x))/(1+exp(-2x))}
    \label{fig:exp}
\end{figure}

\item[$\bullet$] $f(x)=\sqrt[3]{(4-x^3)/(1+x^2)}$
\bigskip
\begin{lstlisting}
import matplotlib.pyplot as plt
import numpy as np
 
x = np.arange(-10,100,1)#type(x):array
# formulate a function f
f = lambda x : ((4-x**3)/(1+x**2))**(1/3)
 
fig = plt.figure(figsize=[6, 4])
plt.plot(x, f(x),  color = 'skyblue',linewidth=3)
plt.grid(visible = True, color='black',  linewidth=0.3)
plt.xlabel('X'), plt.ylabel('Y')
plt.title('$f(x)=f(x)=\sqrt[3]{(4-x^3)/(1+x^2)}$')
plt.show()
\end{lstlisting}

\begin{figure}[H]
    \centering
        \includegraphics[scale=0.6]{/Users/guoyixuan/Documents/vscodepython/Statistical Calculation/Homework2_Function/image_hw2/3.png}
    \caption{$f(x)=\sqrt[3]{(4-x^3)/(1+x^2)}$}
    \label{fig:exp/exp}
\end{figure}

\item[$\bullet$] $f(x)=1/x$
\bigskip
\begin{lstlisting}
import matplotlib.pyplot as plt
import numpy as np
 
x = np.arange(-50,50,1)#type(x):array
# formulate a function f
f = lambda x : 1/x
 
fig = plt.figure(figsize=[6, 4])
plt.plot(x, f(x),  color = 'green',linewidth=2)
plt.grid(visible = True, color='black',  linewidth=0.3)
plt.xlabel('X'), plt.ylabel('Y')
plt.title('$f(x)=1/x$')
plt.axhline(0,linestyle="--")
plt.axvline(0,linestyle="--")
plt.show()
\end{lstlisting}

\begin{figure}[H]
    \centering
        \includegraphics[scale=0.7]{/Users/guoyixuan/Documents/vscodepython/Statistical Calculation/Homework2_Function/image_hw2/4.png}
    \caption{$f(x)=1/x$}
    \label{fig:1/x}
\end{figure}

\item[$\bullet$] $f(x)=1/(2\sqrt{2 \pi}) \exp(-(x-1)^2/8)$
\bigskip
\begin{lstlisting}
import matplotlib.pyplot as plt
import numpy as np
 
x = np.arange(-20,20,1)#type(x):array
# formulate a function f
f = lambda x : 1/(2*np.sqrt(2*np.pi))*np.exp(-(x-1)**2/8)
 
fig = plt.figure(figsize=[6, 4])
plt.plot(x, f(x),  color = 'red',linewidth=2)
plt.grid(visible = True, color='black',  linewidth=0.3)
plt.xlabel('X'), plt.ylabel('Y')
plt.title('$f(x)=1/(2*sqrt(2*pi))exp(-(x-1)^2/8)$')
plt.show()
\end{lstlisting}

\begin{figure}[H]
    \centering
        \includegraphics[scale=0.7]{/Users/guoyixuan/Documents/vscodepython/Statistical Calculation/Homework2_Function/image_hw2/5.png}
    \caption{$f(x)=1/(2\sqrt{2 \pi}) \exp(-(x-1)^2/8)$}
    \label{fig:1/sqrt}
\end{figure}

\item[$\bullet$] $f(x)=x^{2/3}$
\bigskip
\begin{lstlisting}
import matplotlib.pyplot as plt
import numpy as np
 
x = np.arange(0,50,1)#type(x):array
# formulate a function f
f = lambda x : x**(2/3)
 
fig = plt.figure(figsize=[6, 4])
plt.plot(x, f(x),  color = 'red',linewidth=2)
plt.grid(visible = True, color='black',  linewidth=0.3)
plt.xlabel('X'), plt.ylabel('Y')
plt.title('$f(x)=x**(2/3)$')
plt.show()
\end{lstlisting}

\begin{figure}[H]
    \centering
        \includegraphics[scale=0.7]{/Users/guoyixuan/Documents/vscodepython/Statistical Calculation/Homework2_Function/image_hw2/6.png}
    \caption{$f(x)=x^{2/3}$}
    \label{fig:x^(2/3)}
\end{figure}

\item[$\bullet$]$f(x)=2x^3-x^4$
\bigskip
\begin{lstlisting}
import matplotlib.pyplot as plt
import numpy as np
 
x = np.arange(-35,35,1)#type(x):array
# formulate a function f
f = lambda x : 2*x**3-x**4
 
fig = plt.figure(figsize=[6, 4])
plt.plot(x, f(x),  color = 'red',linewidth=2)
plt.grid(visible = True, color='black',  linewidth=0.3)
plt.xlabel('X'), plt.ylabel('Y')
plt.xlim(-40,40)
plt.title('$f(x)=2*x^3-x^4$')
plt.show()
\end{lstlisting}

\begin{figure}[H]
    \centering
        \includegraphics[scale=0.7]{/Users/guoyixuan/Documents/vscodepython/Statistical Calculation/Homework2_Function/image_hw2/7.png}
    \caption{$f(x)=2x^3-x^4$}
    \label{fig:f(x)=2x^3-x^4}
\end{figure}

\item[$\bullet$]$f(x)=ln(x)/x^3$
\bigskip
\begin{lstlisting}
import matplotlib.pyplot as plt
import numpy as np
 
x = np.arange(-35,35,1)#type(x):array
# formulate a function f
f = lambda x : np.log(x)/x**3
 
fig = plt.figure(figsize=[6, 4])
plt.plot(x, f(x),  color = 'blue',linewidth=2)
plt.grid(visible = True, color='black',  linewidth=0.3)
plt.xlabel('X'), plt.ylabel('Y')
plt.xlim(0,20)
plt.title('$f(x)=ln(x)/x**3$')
plt.show()
\end{lstlisting}

\begin{figure}[H]
    \centering
        \includegraphics[scale=0.7]{/Users/guoyixuan/Documents/vscodepython/Statistical Calculation/Homework2_Function/image_hw2/8.png}
    \caption{$f(x)=ln(x)/x^3$}
    \label{fig:f(x)=ln(x)/x^3}
\end{figure}

\item[$\bullet$] $f(x)=3$, $1 \leq x \leq 5$
\bigskip
\begin{lstlisting}
import matplotlib.pyplot as plt
import numpy as np
x=[1,5]
y=[3,3]
fig, ax = plt.subplots()
ax.hlines(y=3,xmin=1,xmax=5,linewidth=2)
plt.plot(x,y,marker="o")
plt.grid(visible = True, color='black',  linewidth=0.3)
plt.xlabel('X'), plt.ylabel('Y')
plt.xlim(0,6)
plt.ylim(0,6)
plt.title('$f(x)=3$')
plt.show()
\end{lstlisting}

\begin{figure}[H]
    \centering
        \includegraphics[scale=0.6]{/Users/guoyixuan/Documents/vscodepython/Statistical Calculation/Homework2_Function/image_hw2/9.png}
    \caption{$f(x)=3$}
    \label{fig:f(x)=3}
\end{figure}

\item[$\bullet$] $x^2+y^2=1$
\bigskip
\begin{lstlisting}
import numpy as np
import matplotlib.pyplot as plt

t = np.linspace(0, 2*np.pi, 200)
r = 1
x = r*np.cos(t)
y = r*np.sin(t)

#刪掉邊線
ax=plt.gca()
ax.spines["right"].set_color("none")
ax.spines["top"].set_color("none")
#挪動x,y軸的位置
ax.spines["bottom"].set_position(("data",0))#data:將x軸綁定在y=0的位置
ax.spines["left"].set_position(("axes",0.5))#axes:將y軸綁定在x軸50%的位置
ax.set_aspect("equal")
plt.plot(x,y)
plt.xlim(-1.5,1.5)
plt.ylim(-1.5,1.5)
plt.title("Parametric Equation Circle")
plt.show()
\end{lstlisting}

\begin{figure}[H]
    \centering
        \includegraphics[scale=0.7]{/Users/guoyixuan/Documents/vscodepython/Statistical Calculation/Homework2_Function/image_hw2/10.png}
    \caption{$f(x)=3$}
    \label{fig:circle}
\end{figure}

\item[$\bullet$] Square
\bigskip
\begin{lstlisting}
import numpy as np
import matplotlib.pyplot as plt

fig, ax = plt.subplots()
ax = plt.gca()
ax.hlines(y=0.5, xmin=-0.5, xmax=0.5, linewidth=2)
ax.hlines(y=-0.5, xmin=-0.5, xmax=0.5, linewidth=2)
ax.vlines(x=0.5, ymin=-0.5, ymax=0.5, linewidth=2)
ax.vlines(x=-0.5, ymin=-0.5, ymax=0.5, linewidth=2)

ax.spines["right"].set_color("none")
ax.spines["top"].set_color("none")
ax.spines["bottom"].set_position(("data",0))#data:將x軸綁定在y=0的位置
ax.spines["left"].set_position(("axes",0.5))#axes:將y軸綁定在x軸50%的位置
ax.set_aspect("equal")

plt.xlim(-1,1)
plt.ylim(-1,1)
plt.xticks(np.arange(-1,1.5,0.5))
plt.yticks(np.arange(-1,1.5,0.5))
plt.title('A square of side 1')
plt.show()
\end{lstlisting}

\begin{figure}[H]
    \centering
        \includegraphics[scale=0.9]{/Users/guoyixuan/Documents/vscodepython/Statistical Calculation/Homework2_Function/image_hw2/11.png}
    \caption{$Square$}
    \label{fig:square}
\end{figure}

除了圖\ref{fig:square}，亦可用其他方式來表達此圖，如下圖\ref{fig:square1}。
\begin{figure}[H]
    \centering
        \includegraphics[scale=0.7]{/Users/guoyixuan/Documents/vscodepython/Statistical Calculation/Homework2_Function/image_hw2/12.png}
    \caption{$Square$}
    \label{fig:square1}
\end{figure}

\end{itemize}


\section{專題練習}
接著本文列舉三個小專題來展示套件的應用。
Let $S_n=\sum_{k=1}^{n}\frac{1}{k}=1+\frac{1}{2}+\frac{1}{3+...+\frac{1}{n}}$
\begin{itemize}
\item[(a)] Verify that $\lim_{n \to \infty}S_n$ diverges.
\item[(b)] Let $\gamma_n$ denote the sum of the shade areas. Show that $\gamma_n-ln(n+1)$.
\item[(c)] Verify that $\frac{1}{2}(1-\frac{1}{n+1}) < \gamma_n < 1.$
\end{itemize}

{\bf Answer}:

\begin{itemize}
\item[(a)]
\bigskip
\begin{lstlisting}
n = 10
a = np.arange(1,n+1)
print(a)
Sn=(1/a).sum()
print(Sn)

n = 10**np.arange(3)
print(np.arange(3))#[0 1 2]
Sn=np.zeros(len(n)) #挖空集合放不同的n得到的結果
print(n)#[1 10 100]
print(np.arange(len(n)))#[0 1 2]
print(np.arange(1,n[1]+1))#[1 2 3 4 5 6 7 8 9 10]

n = 10**np.arange(10)
Sn=np.zeros(len(n)) #挖空集合放不同的n得到的結果
for i in np.arange(len(n)):
    a = np.arange(1,n[i]+1)
    Sn[i] = (1/a).sum()
print(Sn)
print(n)

x = n
y = Sn
values = [0, 1, 2, 3, 4, 5, 6, 7, 8, 9]
plt.plot(n,y)
plt.grid(visible = True, color='black',  linewidth=0.3)
plt.xlabel('n'), plt.ylabel('Sn')
plt.title('Sn diverge when n is infty')
#plt.xticks(n,values)
plt.show()
#a = np.arange(1,n[2]+1)
#print(a)
#Sn[2] = (1/a).sum()
#print(Sn[2])
\end{lstlisting}

根據以上程式碼我們可以得到下圖 \ref{fig:infty}，故可得證。
\begin{figure}[H]
    \centering
        \includegraphics[scale=0.6]{/Users/guoyixuan/Documents/vscodepython/Statistical Calculation/Homework2_Function/image_hw2/13.png}
    \caption{$S_n$ diverge when $n \to \infty$}
    \label{fig:infty}
\end{figure}

\item[(b)]
\bigskip
\begin{lstlisting}
import numpy as np
import matplotlib.pyplot as plt

x = np.arange(0,1000,0.1)#type(x):array
# formulate a function f
f = lambda x : 1/x
 
fig = plt.figure(figsize=[6, 4])
plt.plot(x, f(x),  color = 'blue',linewidth=2)
plt.grid(visible = True, color='black',  linewidth=0.3)
plt.xlabel('X'), plt.ylabel('Y')
plt.xlim(0,10)
plt.ylim(0,2)
plt.xticks(np.arange(0,11,1))
plt.title('$f(x)=1/x$')
plt.show()

def func(x):
    return 1/x
x = np.linspace(2,3,1000)
dx = (3-2)/1000
y = func(x)
area = np.sum(y*dx)
#print(func(2)-area)
#print(1-np.log(2))

n = np.arange(1,101)#[1 2 3 4 5 6 7 8 9 10]
gamma2=np.zeros(len(n))
def func(x):
    return 1/x
for i in np.arange(len(n)):#[0 1 2 3 4 5 6 7 8 9]
    x = np.linspace(n[i],n[i]+1,1000)
    dx = (2-1)/1000
    y = func(x)
    area = np.sum(y*dx)
    gamma2[i] = func(i+1)-area+gamma2[i-1]
print(gamma2)

n = np.arange(1,101)#[1 2 3 4 5 6 7 8 9 10]
Sn = np.zeros(len(n))
gamma1 = np.zeros(len(n))
for i in np.arange(len(n)):#[0 1 2 3 4 5 6 7 8 9]
    a = np.arange(1,n[i]+1)
    Sn[i] = (1/a).sum()
    gamma1[i] = Sn[i]-np.log(n[i]+1)
#print(Sn)
print(gamma1)
print(3/2-np.log(3))

fig, ax = plt.subplots(figsize = (9,6))
plt.subplot(1,2,1)
plt.plot(n,gamma1,color="red")
plt.grid(visible = True, color='black',  linewidth=0.3)
plt.xlabel('n'), plt.ylabel('gamma_n')
plt.title('gamma_n ')

plt.subplot(1,2,2)
plt.plot(n,gamma2,color="blue")
plt.grid(visible = True, color='black',  linewidth=0.3)
plt.xlabel('n'), plt.ylabel('Sn+ln(n+1)')
plt.title('Sn+ln(n+1)')
plt.show()

\end{lstlisting}

\begin{figure}[H]
    \centering
        \includegraphics[scale=0.6]{/Users/guoyixuan/Documents/vscodepython/Statistical Calculation/Homework2_Function/image_hw2/15.png}
    \caption{$\gamma_n$ and $S_n+ln(n+1)$}
    \label{fig:gamma_n}
\end{figure}

根據圖 \ref{fig:gamma_n} 以及以上程式碼我們可以求得從 $n=1$ 到 $n=100$ 時，$\gamma_n$ 與 $S_n+ln(n+1)$ 個別的值，由此可以發現兩者的值基本趨近相同，故可得證。

另外，我們也可直接利用數學進行證明，其過程如下:
$$\gamma_n=\sum_{k=1}^{n} \int_{x=k}^{k+1}(\frac{1}{k}-\frac{1}{x})dx 
=\sum_{k=1}^{n}(\int_{k}^{k+1}\frac{1}{k}-\int_{k}^{k+1}\frac{1}{x} dx)=\sum_{k=1}^{n}(\frac{1}{k}-ln \left| k+1 \right|+ln \left| k \right|)$$
$$=S_n-(ln2+ln3+...+ln(n)+ln(n+1))+(ln1+ln2+ln3+...+ln(n))$$
$$=S_n-ln(n+1)$$

\item[(c)]
\bigskip
\begin{lstlisting}
import numpy as np
import matplotlib.pyplot as plt

x = np.arange(0,1000,0.1)#type(x):array
# formulate a function f
f = lambda x : 1/x

n = np.arange(1,101)#[1 2 3 4 5 6 7 8 9 10]
gamma2=np.zeros(len(n))
def func(x):
    return 1/x
for i in np.arange(len(n)):#[0 1 2 3 4 5 6 7 8 9]
    x = np.linspace(n[i],n[i]+1,1000)
    dx = (2-1)/1000
    y = func(x)
    area = np.sum(y*dx)
    gamma2[i] = func(i+1)-area+gamma2[i-1]

n = np.arange(1,101)
theta = np.zeros(len(n))
for i in np.arange(len(n)):
    theta[i] = 1/2*(1-1/(n[i]+1))


fig, ax = plt.subplots(figsize = (9,6))
plt.plot(n,gamma2,label="gamma_n",color="green")
plt.plot(n,theta,label="1/2(1-1/(n+1))",color="blue")
plt.axhline(1,color="red",label="1")
plt.ylim(0,1.1)
plt.xlim(0,100)
plt.xticks(np.arange(0,100,20))
plt.yticks(np.arange(0,1.1,0.1))
plt.grid(visible = True, color='black',  linewidth=0.3)
plt.xlabel('n'), plt.ylabel('Sn+ln(n+1)')

plt.legend(loc="lower right")
plt.show()

\end{lstlisting}

由上面程式碼與圖 \ref{fig:gamma_n2} 我們即可得證$\frac{1}{2}(1-\frac{1}{n+1}) < \gamma_n < 1$。

\begin{figure}[H]
    \centering
        \includegraphics[scale=0.6]{/Users/guoyixuan/Documents/vscodepython/Statistical Calculation/Homework2_Function/image_hw2/16.png}
    \caption{$\frac{1}{2}(1-\frac{1}{n+1}) < \gamma_n < 1$}
    \label{fig:gamma_n2}
\end{figure}

\end{itemize}

\section{小結}

在上面兩節，我們練習了套件 Matplotlib 的基本繪圖技巧，並也由此對機率函數有一些更深入的認知，望對以後使用 Python 進行繪圖有所幫助。


\end{document}